<!-- DATA DE USUARIO -->
<app-mim-asociado-detalle [configuracion]="datosAsociado" *ngIf="datosAsociado"></app-mim-asociado-detalle>
<div class="row mx-0 w-100 pb-5">
  <div class="col-1 col-xl-3">
    <app-mim-filtro-vertical>
      <!-- Filtros -->
      <app-mim-filtro-vertical-item [label]="'global.consultar'">
        <div class="card cards--panelLeft mb-4">
          <div id="filtroBeneficiario" class="collapse show" aria-labelledby="headingOne"
            data-parent="#accordionPanelLeft">
            <div class="card-body ">
              <form class="form--default" *ngIf="isForm | async as isForm" [formGroup]="form"
                (ngSubmit)="onBuscar($event)">
                <!--Liquidacion -->
                <div class="form-group row px-3">
                  <div class="checkbox-coomeva">
                    <label appMimLabel for="filtroLiquidacion">
                      {{
                        'eventos.consulta.filtros.identificacionAsociado'
                          | translate
                      }}
                    </label>
                    <input id="filtroLiquidacion" name="tipoFiltro" type="radio" [value]="1"
                      formControlName="tipoFiltro" />
                    <label class="checkmark-coomeva" for="filtroLiquidacion">
                    </label>
                  </div>
                  <div class="input-group" appMimInput [for]="'identificacion'" [controlName]="'identificacion'">
                    <input type="text" mask="f*" [patterns]="patterns" class="form-control" id="identificacion"
                      formControlName="identificacion" name="identificacion" />
                  </div>
                  <app-mim-input-error class="col-sm-12" controlName="identificacion" errorKey="required">
                    {{ 'global.required' | translate  : { campo: 'eventos.consulta.filtros.identificacionAsociado' | translate } }}
                  </app-mim-input-error>
                  <app-mim-input-error class="col-sm-12" controlName="identificacion" errorKey="maxlength">
                    {{ 'eventos.consulta.filtros.mensajes.maxlenth' | translate : {numero: 15} }}
                  </app-mim-input-error>
                </div>

                <!--Identificacion codigo solicitud -->
                <div class="form-group row px-3 pb-3">
                  <div class="checkbox-coomeva">
                    <label appMimLabel for="filtroIdentificacion">
                      {{
                        'eventos.consulta.filtros.codigoEvento'
                          | translate
                      }}
                    </label>
                    <input id="filtroIdentificacion" name="tipoFiltro" type="radio" [value]="2"
                      formControlName="tipoFiltro" />
                    <label class="checkmark-coomeva" for="filtroIdentificacion">
                    </label>
                  </div>
                  <div class="input-group" appMimInput [for]="'liquidacion'" [controlName]="'liquidacion'">
                    <input type="text" class="form-control" id="liquidacion" formControlName="liquidacion"
                      name="liquidacion" mask="f*" [patterns]="patterns" />
                  </div>
                  <app-mim-input-error class="col-sm-12" controlName="liquidacion" errorKey="required">
                    {{ 'global.required' | translate  : { campo: 'eventos.consulta.filtros.codigoEvento' | translate } }}
                  </app-mim-input-error>
                  <app-mim-input-error class="col-sm-12" controlName="liquidacion" errorKey="maxlength">
                    {{ 'eventos.consulta.filtros.mensajes.maxlenth' | translate : {numero: 20} }}
                </app-mim-input-error>
                </div>

                <div class="form-group">
                  <div class="row mx-auto w-100">
                    <div class="col-md-6 pl-md-0">
                      <button type="button" class="btn btn--gray2 btn--md w-100 justify-content-md-start "
                        (click)="onLimpiar()">
                        {{ 'global.clean' | translate }}
                        <span class="icon-cross ml-3"></span>
                      </button>
                    </div>
                    <div class="col-md-6 pr-md-0">
                      <button class="btn btn--border_green1 btn--md w-100" type="submit">
                        {{ 'global.search' | translate }}
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </app-mim-filtro-vertical-item>
    </app-mim-filtro-vertical>
  </div>

  <!-- Consulta Pagos -->
  <div class="col-11 col-xl-9 offset-1 offset-xl-0 d-block py-5 px-0 m-0">
    <div class="row mx-0 w-100 ">
      <!-- Titulo -->
      <div class="col-md-12">
        <h1>{{ 'eventos.consulta.titulo' | translate }}</h1>
      </div>
      <div class="col-md-12">
        <app-mim-grid (clickCeldaElement)="_onClickCeldaElement($event)"
         [configuracion]="configuracion.gridEvento">
        </app-mim-grid>
      </div>
    </div>
  </div>
</div>

<app-popup-menu [configuracion]="configuracion.popupMenu" (click-item)="_onClickItemPopup($event)">
</app-popup-menu>

<!--Controles -->
<div class="card cards--footer border-0 rounded-0 panel-crear-cuenta z-index-footer" *ngIf="mostrarBotonNuevoEvento">
  <div class="card-body py-2">
      <div class="row mx-0 w-10 justify-content-end align-items-center">
          <!-- Botones -->
          <div class="col-xl-12">
              <div class="d-flex flex-row-reverse">
                <button type="submit" class="btn btn--orange1 btn--md mr-2" (click)="_nuevoEvento()">
                  <span class="icon-plus mr-2"></span>{{ 'eventos.consulta.botones.nuevoEvento' | translate }}
                </button>
              </div>
          </div>
      </div>
  </div>
</div>

<!-- Modal anulaci贸n -->
<div class="sidebar--slide sidebar--slide_right d-flex align-items-center" [ngClass]="{ open: mostrarModalAnulacion == true }"
    *ngIf="mostrarModalAnulacion">
    <div class="row mx-0 w-100 justify-content-center">
        <div class="col-xl-5 col-md-7 px-0">
            <div class="card  bg--white">
                <div class="card-body">
                    <h2 class="text--gray1 text--500wt text-center">
                        {{ 'eventos.consulta.solicitud.anulacion.titulo' | translate: { nroSolicitud: idProceso | translate } }}
                    </h2>

                    <form class="form--default col w-100 pt-4" [formGroup]="formAnulacion"
                        *ngIf="isFormAnulacion | async as isFormAnulacion">

                        <!-- Causa anulaci贸n -->
                        <div class="form-group row align-items-center">
                            <label class="col-sm-12 col-form-label" appMimLabel for="causaAnulacion">
                                {{ 'eventos.consulta.solicitud.anulacion.causa' | translate }}
                            </label>
                            <div class="col-sm-12 pt-1">
                                <div class="input-group" appMimInput [for]="'causaAnulacion'" [controlName]="'causaAnulacion'">
                                    <app-mim-select class="w-100" [inputId]="'causaAnulacion'"
                                        [options]="razonesAnulacion" formControlName="causaAnulacion"
                                        [optionKey]="'nombre'" ngDefaultControl>
                                    </app-mim-select>
                                </div>
                            </div>
                            <app-mim-input-error class="col-sm-12" controlName="causaAnulacion" errorKey="required">
                              {{ 'global.required' | translate  : { campo: 'eventos.consulta.solicitud.anulacion.causa' | translate } }}
                            </app-mim-input-error>
                        </div>

                        <!-- Usuario anulaci贸n -->
                        <div class="form-group row align-items-center" *ngIf="mostrarUsuariosAnulacion">
                          <label class="col-sm-12 col-form-label" appMimLabel for="usuarioAnulacion">
                              {{ 'eventos.consulta.solicitud.anulacion.usuario' | translate }}
                          </label>
                          <div class="col-sm-12 pt-1">
                              <div class="input-group" appMimInput [for]="'usuarioAnulacion'" [controlName]="'usuarioAnulacion'">
                                  <app-mim-select class="w-100" [inputId]="'usuarioAnulacion'"
                                      [options]="usuariosAnulacion" formControlName="usuarioAnulacion"
                                      [optionKey]="'nombre'" ngDefaultControl>
                                  </app-mim-select>
                              </div>
                          </div>
                          <app-mim-input-error class="col-sm-12" controlName="usuarioAnulacion" errorKey="required">
                            {{ 'global.required' | translate  : { campo: 'eventos.consulta.solicitud.anulacion.usuario' | translate } }}
                          </app-mim-input-error>
                      </div>

                        <!-- Observaci贸n -->
                        <div class="form-group row align-items-center">
                            <label appMimLabel for="observacion" class="col-sm-12 col-form-label">
                                {{ 'eventos.consulta.solicitud.anulacion.observacion' | translate }}
                            </label>
                            <div class="col-sm-12">
                                <div class="input-group" appMimInput [for]="'observacion'" [controlName]="'observacion'">
                                    <textarea type="text" rows="5" class="form-control" id="observacion"
                                        formControlName="observacion" name="observacion" maxlength="1000" mask="a*"
                                        [patterns]="patterns" [dropSpecialCharacters]="false">
                                    </textarea>
                                </div>
                            </div>
                            <app-mim-input-error class="col-sm-12" controlName="observacion" errorKey="required">
                                {{ 'global.required' | translate  : { campo: 'eventos.consulta.solicitud.anulacion.observacion' | translate } }}
                            </app-mim-input-error>
                            <app-mim-input-error class="col-sm-12" controlName="observacion" errorKey="maxlength">
                                {{ 'global.maxCaracteres' | translate :{ campo: 'eventos.consulta.solicitud.anulacion.observacion' | translate, max: '1000' | translate } }}
                            </app-mim-input-error>
                        </div>
                        <div class="row justify-content-center">
                            <button class="btn btn--md btn--blue1 btn-min-with mx-2" (click)="guardarAnulacion()"
                              [disabled]="!habilitarGuardar">
                                {{ 'global.accept' | translate }}
                            </button>
                            <button class="btn btn--md btn--gray2 btn-min-with mx-2" (click)="cancelarAnulacion()"
                            [disabled]="!habilitarGuardar">
                              {{ 'global.cancel' | translate }}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal observacion -->
<div class="sidebar--slide sidebar--slide_right d-flex align-items-center" [ngClass]="{ open: mostrarModalObservaciones == true }"
    *ngIf="mostrarModalObservaciones">
    <div class="row mx-0 w-100 justify-content-center">
        <div class="col-xl-5 col-md-7 px-0">
            <div class="card  bg--white">
              <div class="car-body">

                <form class="form--default col w-100 pt-4" [formGroup]="formObservacion" *ngIf="_isLoad | async as _isLoad;">

                  <h2 class="text--gray1 text--500wt text-center mt-2">
                    {{ 'eventos.consulta.solicitud.observaciones.titulo' | translate}}
                  </h2>

                  <div class="col-sm-12">
                    <div class="input-group">
                        <textarea type="text" rows="5" style="border: 0.5px solid rgb(197, 194, 194) !important" formControlName="controlObservacion" class="form-control" id="observacion"
                            name="observacion" maxlength="1000">
                        </textarea>
                    </div>
                  </div>

                  <app-mim-input-error class="col-sm-12" controlName="controlObservacion" errorKey="cannotContainSpace">
                    {{ 'global.required' | translate  : { campo: 'eventos.consulta.solicitud.anulacion.observacion' | translate } }}
                  </app-mim-input-error>
                  <app-mim-input-error class="col-sm-12" controlName="controlObservacion" errorKey="maxlength">
                    {{ 'global.maxCaracteres' | translate :{ campo: 'eventos.consulta.solicitud.anulacion.observacion' | translate, max: '1000' | translate } }}
                  </app-mim-input-error>

                  <div class="row justify-content-center mb-1">
                    <button class="btn btn--md btn--blue1 btn-min-with mx-2" (click)="guardarObservacion(formObservacion)">
                        {{ 'global.save' | translate }}
                    </button>
                    <button class="btn btn--md btn--gray2 btn-min-with mx-2" (click)="cancelarObservacion()">
                      {{ 'global.cancel' | translate }}
                    </button>
                  </div>

                </form>

              </div>
            </div>
        </div>
    </div>
</div>
